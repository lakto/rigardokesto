<!doctype html><html data-theme="dark" lang="id"><head><meta charset="utf-8"><meta content="A simple, fully customizable comment system using Supabase as the database. Easily manage, display, and store comments with complete control and flexibility" name="description"><meta content="#ffffff" name="theme-color" media="(prefers-color-scheme: light)"><meta content="#1f1f1f" name="theme-color" media="(prefers-color-scheme: dark)"><meta content="comment system, apoxicam, supabase" name="keyword"><meta content="" name="author"><meta content="width=device-width,initial-scale=1" name="viewport"><link href="/asset/index/favicon.ico" rel="icon" type="image/x-icon"><title>Configure Comment System</title><meta content="Configure Comment System" property="og:title"><meta content="https://blog.milchkannen.ch/asset/blog/comment.webp" property="og:image"><meta content="summary_large_image" name="twitter:card"><meta content="Configure Comment System" name="twitter:title"><meta content="A simple, fully customizable comment system using Supabase as the database. Easily manage, display, and store comments with complete control and flexibility" name="twitter:description" id="twitter-description"><meta content="https://blog.milchkannen.ch/asset/blog/comment.webp" name="twitter:image"><link href="/asset/css/style.css" rel="stylesheet"><meta content="same-origin" name="view-transition"><link href="/asset/js/search.js" rel="modulepreload" as="script" crossorigin><link href="/asset/js/search-global.js" rel="modulepreload" as="script" crossorigin><script src="/asset/js/lazysizes.min.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","name":"Configure Comment System","url":"https://blog.milchkannen.ch/blog/configure-comment-system/"}</script></head><body class="bg-base-200" data-theme="dark"><div class="min-h-screen sm:hero"><div class="the-container"><div class="the-card"><div class="rounded-t-xl the-navbar"><div class="navbar-start"><a href="/blog" class="btn btn-circle btn-ghost" aria-label="back"><svg class="feather feather-list" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" height="24" width="24"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg> </a><a href="/" class="btn btn-circle btn-ghost" aria-label="home"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/><polyline points="9 22 9 12 15 12 15 22" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg></a></div><div class="navbar-end"><button class="btn btn-circle btn-ghost" onclick="sharePost()" aria-label="share"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></svg></button><script>function copyToClipboard(){var e=document.getElementById("share-url");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value).then(()=>{alert("URL copied to clipboard")}).catch(e=>{console.error("Failed to copy: ",e)})}function sharePost(){navigator.share?navigator.share({title:document.title,url:location.href}).catch(e=>{"AbortError"!==e.name&&(console.warn("Failed to use native share API. ",e),share.showModal())}):share.showModal()}</script></div></div><div class="flex-grow"><div class="card-body pt-4 tn:pt-8"><div class="w-full"><div class="prose max-w-none"><h3>Configure Comment System</h3><div class="text-sm mb-6 mt-0 mx-0">A simple, fully customizable comment system using Supabase as the database. Easily manage, display, and store comments with complete control and flexibility</div><p>This starter includes a built-in comment system, thanks to my friend <a href="https://mustofa.id">Mustofa-ID</a> for helping me set it up. The comment system uses Supabase as the database.</p><blockquote><p>Here we go</p></blockquote><h3>Supabase</h3><ol><li><p><strong>Create a Supabase Account</strong><br>First, create an account on <strong><a href="https://supabase.com">Supabase</a></strong>.</p></li><li><p><strong>Create a New Project</strong><br>Once logged in, create a new project with the name of your website.</p></li><li><p><strong>Create a Table for Comments</strong><br>In the Supabase dashboard, go to <strong><code>SQL Editor</code></strong> and run the following query to create the <code>comments</code> table:</p><pre><code class="language-sql">create table comments (
    id bigint generated by default as identity not null,
    created_at timestamp with time zone not null default now(),
    name character varying not null,
    email character varying null,
    description text null,
    slug character varying not null,
    hidden boolean null,
    constraint comments_pkey primary key (id)
);

alter table comments add column reply_to bigint references comments (id);

create table verified_users (email varchar unique not null);

create view comments_view as 
select
   c.id,
   c.slug,
   c.name,
   c.description,
   c.reply_to,
   c.created_at,
   v.email is not null verified
from comments c
left join verified_users v on v.email = c.email
where (c.hidden is null or c.hidden = false);

</code></pre></li><li><p><strong>Run the Query</strong><br>Copy the query into the editor and click the <strong>Run</strong> button. This will create the <code>comments</code> table.</p></li><li><p><strong>Create Policies</strong><br>Set up policies to allow users to insert and view comments. Run the following queries in the <strong><code>SQL Editor</code></strong>:</p><pre><code class="language-sql">create policy "Enable insert with email check"
on comments as permissive for insert to anon
with check (email not in (select email from verified_users));

create policy "Allow select for all users"
on comments for select
using (hidden = false);

alter policy "Allow select for authenticated users only"
on verified_users
to authenticated using (true);
</code></pre></li></ol><h3>Configure the Comment System</h3><ol><li><p><strong>Get Supabase Project URL and API Key</strong><br>In your Supabase dashboard, go to <strong><code>Project Settings</code></strong> > <strong><code>API</code></strong>.<br>Here, you will find the <strong>Project URL</strong> and <strong>API Key</strong> (<code>anon public</code>).</p></li><li><p><strong>Create an <code>.env</code> File</strong><br>Create a <code>.env</code> file in your deployment provider (such as GitHub Pages, Netlify, etc.), and add the following variables:</p><pre><code class="language-env">SUPABASE_URL=https://your-project-url.supabase.co
SUPABASE_KEY=your-anon-public-api-key
</code></pre></li><li><p><strong>Local Development</strong><br>You can also create a <code>.env</code> file for local development, but avoid hard-coding the values directly into your code.</p></li></ol><p>If you want to modify the comment layout, simply check the files <code>_include/js/comment.js</code> and <code>_include/post/comment.html</code>.</p><p>Please note that you need to manually update the <strong>hidden column value</strong> for each new comment in Supabase. A value of false means the comment will be displayed on your website.</p><p>I haven’t figured out how to set up email notifications yet, but I’ll work on it and write a post about it once I do.</p><blockquote><p>That's it! Your comment system is now configured. Have any question?</p></blockquote></div></div></div></div><div class="border-base-200 border-t"></div><div class="bg-base-100 card-action navbar px-4 rounded-b-xl"><div class="navbar-start"><a href="/blog/new-year/" class="btn btn-circle btn-ghost" aria-label="next"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor"><path d="M10 19l-7-7m0 0l7-7m-7 7h18" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg></a></div><div class="navbar-center py-4 text-center"><p class="text-sm"><a href="/" class="font-bold hover:underline text-primary">Milchkannen</a> © <script>document.write((new Date).getFullYear())</script></p></div><div class="navbar-end"><a href="/blog/photos-license/" class="btn btn-circle btn-ghost" aria-label="previous"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor"><path d="M14 5l7 7m0 0l-7 7m7-7H3" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg></a></div></div></div></div><dialog class="modal" id="share"><div class="modal-box"><div class="mb-4 alert alert-warning" role="alert"><svg class="h-6 shrink-0 stroke-current w-6" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg> <span>Sorry, your system didn't support webShareAPI. Please click copy button below</span></div><div class="flex items-center"><input class="w-full input input-bordered mr-4" type="text" aria-label="link" disabled id="share-url" value="https://blog.milchkannen.ch/blog/configure-comment-system/"> <button class="btn btn-primary" onclick="copyToClipboard()">Copy</button></div></div><form class="modal-backdrop" method="dialog"><button>close</button></form></dialog><dialog class="modal modal-bottom sm:modal-middle" id="modalComment"><div class="modal-box"><style>[data-hidden=true]{display:none}</style><div class="font-bold my-4 prose text-md">Leave your comment below</div><section><form class="w-full gap-3 form-control" method="post" action="." id="comment-form"><div class="w-full gap-3 flex"><input class="bg-base-200 input w-full" type="text" name="name" placeholder="Full name" spellcheck="false" required> <input class="bg-base-200 input w-full" type="email" name="email" placeholder="Email (opsional)" spellcheck="false"></div><textarea class="bg-base-200 textarea" minlength="7" name="description" placeholder="Type your comment" required rows="3"></textarea> <input name="reply_to" hidden> <button class="btn btn-primary mt-2 w-28" name="submit" type="submit">Send</button></form></section><section class="mt-4"><button class="hover:text-primary" id="comment-list-loader">See comments</button><article class="flex flex-col gap-2 mt-6" id="comment-list-container"><section class="bg-base-200 card" hidden id="comment-list-item-[[id]]"><div class="card-body p-3"><div class="flex items-center justify-between"><p><strong class="text-secondary">[[name]] </strong><span class="text-accent" data-hidden="[[!verified]]" title="Verified user">★ </span>– <em class="text-xs" title="[[created_at]]">[[relative_time]]</em></p><button class="btn btn-primary btn-xs" onclick="reply_comment(this)" data-comment-id="[[id]]">Reply</button></div><p>[[description]]</p></div></section><article class="flex flex-col gap-2 mb-4 pl-4 pt-4" id="reply-list-container-[[id]]" hidden><section class="bg-base-200 card" hidden id="reply-list-item-[[id]]"><div class="card-body p-3"><p><strong class="text-secondary">[[name]]</strong> <span class="text-accent" data-hidden="[[!verified]]" title="Verified user">★ </span>– <em class="text-xs" title="[[created_at]]">[[relative_time]]</em></p><p>[[description]]</p></div></section></article></article></section><script>window.SUPABASE_URL="",window.SUPABASE_KEY=""</script><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script src="/asset/js/comment.js"></script></div><form class="modal-backdrop" method="dialog"><button>close</button></form></dialog></div></body></html>